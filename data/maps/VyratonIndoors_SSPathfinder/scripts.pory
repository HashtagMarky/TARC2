mapscripts VyratonIndoors_SSPathfinder_MapScripts
{
    MAP_SCRIPT_ON_FRAME_TABLE
    [
        VAR_IKIGAI_INTRO_STATE, 1: VyratonIndoors_SSPathfinder_IkigaiIntroSetup
    ]
}

const LOCALID_Captain = 1

script VyratonIndoors_SSPathfinder_IkigaiIntroSetup
{
    setvar(VAR_IKIGAI_INTRO_STATE, 2)
    setdynamicwarp(MAP_VYRATON_OUTDOORS_HARBOUR, 15, 25)
}

script VyratonIndoors_SSPathfinder_EventScript_MeetCaptain
{
    setvar(VAR_TEMP_0, 1)
    turnplayer(DIR_NORTH)
    opendoor(4, 1)
    playse(SE_DOOR)
    waitdooranim
    applymoveplayer(VyratonIndoors_SSPathfinder_Movement_Player_NoExit, FALSE)
    applymove(LOCALID_Captain, Common_Movement_DoorEntrance)
    closedoor(4, 1)
    waitdooranim
    mnmbox(VyratonIndoors_SSPathfinder_Text_IntroduceCaptain, nameKnown=FALSE, localId=LOCALID_Captain)
    applymoveplayer(VyratonIndoors_SSPathfinder_Movement_Player_LeadIn, FALSE)
    applymove(LOCALID_Captain, VyratonIndoors_SSPathfinder_Movement_Captain_FollowIn)
    mnmbox(VyratonIndoors_SSPathfinder_Text_WhatBringsYou, nameKnown=FALSE, remain=TRUE)
    call(VyratonIndoors_SSPathfinder_Text_WhatBringsYou_PlayerDialogue)
    mnmbox(VyratonIndoors_SSPathfinder_Text_GranddaughtersAdvice)
}

script VyratonIndoors_SSPathfinder_Text_WhatBringsYou_PlayerDialogue
{
    dynmultichoice(0, 0, TRUE, 1, 0, DYN_MULTICHOICE_CB_NONE, "I wanted a fresh start.", "I'm moving for a new challenge.", "I'm going for business.")
    switch (var(VAR_RESULT))
    {
        case 0: bufferstring(STR_VAR_1, VyratonIndoors_SSPathfinder_Text_WhatBringsYou_FreshStart)
        case 1: bufferstring(STR_VAR_1, VyratonIndoors_SSPathfinder_Text_WhatBringsYou_NewChallenge)
        case 2: bufferstring(STR_VAR_1, VyratonIndoors_SSPathfinder_Text_WhatBringsYou_Business)
    }
}

movement VyratonIndoors_SSPathfinder_Movement_Player_NoExit
{
    lock_facing_direction
    walk_down
    unlock_facing_direction
}

movement VyratonIndoors_SSPathfinder_Movement_Player_LeadIn
{
    walk_down * 2
    face_up
}

movement VyratonIndoors_SSPathfinder_Movement_Captain_FollowIn
{
    walk_down
    delay_16
    delay_2
}
